<div class="pb-4">Select the report you wish to Schedule from the list below</div>
<div *ngIf="isLoading" class="spinner">
    <p-progressSpinner animationDuration="1s"></p-progressSpinner>
</div>
<div class="border-1 border-300">
    <div class="p-input-icon-left col-12 border-bottom-1 border-300">
        <i class="pi pi-search ml-2" aria-hidden="true"></i>
        <input type="text" placeholder="Search by name/description" [(ngModel)]="searchText" autofocus pInputText />
    </div>
    <div class="grid">
        <div class="col-12">
            <div class="card">
                <ng-container *ngIf="scheduleReports$ | async as reports">
                    <p-dataView
                        #dv
                        [value]="reports | reportFilter : searchText"
                        [rows]="4"
                        [paginator]="true"
                        [trackBy]="trackByFn"
                    >
                        <ng-template let-report pTemplate="listItem">
                            <div class="col-12 cursor-pointer" [ngClass]="{ 'bg-blue-100': report.isSelected }">
                                <app-report-item
                                    [report]="report"
                                    [user]="user"
                                    [tab]="'schedule'"
                                    [projectId]="reportData?.projectDetails.project_id"
                                    (showScheduleError)="showScheduleError($event)"
                                    (refreshSchedule)="getScheduleReports()"
                                ></app-report-item>
                            </div>
                        </ng-template>
                    </p-dataView>
                </ng-container>
            </div>
        </div>
    </div>
    <div class="grid">
        <div class="col-12" *ngIf="reportError">
            <p-message severity="error" [text]="reportError"></p-message>
        </div>
    </div>
    <div class="grid mt-2">
        <div class="col-12">
            <div class="flex justify-content-end">
                <p-button
                    type="button"
                    label="Schedule"
                    class="p-button-md create-btn mr-2"
                    icon="pi pi-calendar"
                    iconPos="left"
                    (click)="schedule()"
                    [enabled]="reportSchedules.length > 0"
                ></p-button>
            </div>
        </div>
    </div>
</div>
<p-confirmDialog #cd [style]="{ width: '50vw' }">
    <ng-template pTemplate="header">
        <h3>Warning</h3>
    </ng-template>
    <ng-template pTemplate="footer">
        <p-button
            type="button"
            styleClass="p-button-secondary p-button-text"
            icon="pi pi-times"
            label="No"
            (click)="cd.reject()"
        ></p-button>
        <p-button
            type="button"
            styleClass="p-button-danger"
            icon="pi pi-check"
            label="Yes"
            (click)="cd.accept()"
        ></p-button>
    </ng-template>
</p-confirmDialog>
